<?xml version="1.0" encoding="UTF-8"?>
<CsvImport _uuid="x0opUKJzLmFK0pwGm45IhQ" name="logic.person.attendance.summaryMonth" label="考勤-月报表CSV信息" is_valid="Y">
  <Columns _uuid="9kxp8t2ONIWCeV]XvKiLtQ" name="Columns" label="列集合" is_valid="Y">
    <Column _uuid="zET[[oWOJkfiSSPjJf66tg" name="work_number" label="工号" is_valid="Y" data_name="WORK_NUMBER" />
    <Column _uuid="LUfSonMC19YvUOHWsQhqng" name="user_label" label="姓名" is_valid="Y" data_name="USER_LABEL" />
    <Column _uuid="30GhTJg4h83[JlQZgJ0LuA" name="organization_label" label="组织" is_valid="Y" data_name="ORGANIZATION_LABEL" />
    <Column _uuid="]EUXLj3kQXrw1p6Bweh1pg" name="attendance_days" label="应出勤(天)" is_valid="Y" data_name="ATTENDANCE_DAYS" />
    <Column _uuid="4EjsfRlqPq8lJOvbsCBEow" name="real_attendance" label="实际出勤(天)" is_valid="Y" data_name="REAL_ATTENDANCE" />
    <Column _uuid="RUQKeQ88QeDYI0LvZ3jRvw" name="total_absent_ts" label="实际缺勤(天)" is_valid="Y" data_name="TOTAL_ABSENT_TS" />
    <Column _uuid="aENpxdw7TP4vaeipZ3a0jA" name="absenteeism_ts" label="旷工(天)" is_valid="Y" data_name="ABSENTEEISM_TS" />
    <Column _uuid="rUG2hiY2LGOBCpFpzTXbpA" name="late_count" label="迟到(次)" is_valid="Y" data_name="LATE_COUNT" />
    <Column _uuid="BERgrFmhpiXF6XS[[FUbjA" name="leave_count" label="早退(次)" is_valid="Y" data_name="LEAVE_COUNT" />
    <Column _uuid="wk3mgzJaUF9ktQTzF0Rmmg" name="week_days" label="双休(天)" is_valid="Y" data_name="WEEK_DAYS" />
    <Column _uuid="fU0QQiBeay[q3ukqu5XTkQ" name="holiday_days" label="节假(天)" is_valid="Y" data_name="HOLIDAY_DAYS" />
    <Column _uuid="fEvWimZZc3GnTVLO57crrg" name="casual_rest" label="事假(天)" is_valid="Y" data_name="CASUAL_REST" />
    <Column _uuid="5ERNk7o1ftW[0X9zMLl2lg" name="sick_rest" label="病假(天)" is_valid="Y" data_name="SICK_REST" />
    <Column _uuid="XUeXTJZ9TXUeikVX114Dqg" name="vacation_rest" label="年假(天)" is_valid="Y" data_name="VACATION_REST" />
    <Column _uuid="G0VCcaGpFHOe[Y3OcrErog" name="marriage_rest" label="婚假(天)" is_valid="Y" data_name="MARRIAGE_REST" />
    <Column _uuid="H0glkgtSzEIfzsWdgh0fvA" name="maternityRest" label="产假(天)" is_valid="Y" data_name="MATERNITY_REST" />
    <Column _uuid="o0cwfUVOtiWAxXVAcvM2gQ" name="mourningRest" label="丧假(天)" is_valid="Y" data_name="MOURNING_REST" />
    <Column _uuid="Vkmh7nqw4lrc3BPj0FZwlw" name="month_note" label="备注" is_valid="Y" data_name="MONTH_NOTE" />
    <Column _uuid="D0HoZqqGLU3OwvCBMa6gvg" name="service_cd" label="在职状态" is_valid="Y" data_name="SERVICE_CD" />
    <Column _uuid="iUvE3P4dF5flp9cQUzxcgQ" name="entry_date" label="入职日期" is_valid="Y" data_name="ENTRY_DATE" />
    <Column _uuid="yEi]zHLWjQhbdfzb5fxiog" name="leave_date" label="离职日期" is_valid="Y" data_name="LEAVE_DATE" />
    <Column _uuid="[UFfkseRCPt9u24HZ[6NkQ" name="leave_rest_count" label="离职年假折算(天)" is_valid="Y" data_name="LEAVE_REST_COUNT" is_require="Y" />
  </Columns>
  <Export _uuid="fE]SvLqspPb0tvLWE7Evgg" name="sql" label="考勤-月报表" is_valid="Y" sql="SELECT\n   WORK_NUMBER,\n   USER_LABEL,\n   ORGANIZATION_LABEL,\n   CP_TIME_SPAN.Format_Day_By_Calendar(PM_ATTENDANCE_SUMMARY_DI.Get_Attendance_Days(CALENDAR_ID, OUID, CP_DATE.Parse('${BEGIN_DATE}'), \n      CP_DATE.Parse('${END_DATE}')),'90.0000', CALENDAR_ID) ATTENDANCE_DAYS,\n   CP_TIME_SPAN.Format_Day_By_Calendar(PM_ATTENDANCE_SUMMARY_DI.Get_Total_Attendance_Ts(CALENDAR_ID, OUID, \n      CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')),'90.0000', CALENDAR_ID) REAL_ATTENDANCE,\n   LATE_COUNT,\n   LEAVE_COUNT,\n   CP_TIME_SPAN.Format_Day_By_Calendar(PM_ATTENDANCE_SUMMARY_DI.Get_Total_Absent_Ts(OUID, CP_DATE.Parse('${BEGIN_DATE}'), \n      CP_DATE.Parse('${END_DATE}')), '90.0000', CALENDAR_ID) TOTAL_ABSENT_TS,\n   CP_TIME_SPAN.Format_Day_By_Calendar(ABSENTEEISM_TS, '90.0000', CALENDAR_ID) ABSENTEEISM_TS,\n   PM_ATTENDANCE_SUMMARY_DI.Get_Weekend_Days(CALENDAR_ID, OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) WEEK_DAYS,\n   PM_ATTENDANCE_SUMMARY_DI.Get_Holiday_Days(CALENDAR_ID, OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) HOLIDAY_DAYS,\n   CP_TIME_SPAN.Format_Day_By_Calendar(CASUAL_REST, '90.0000', CALENDAR_ID) CASUAL_REST,\n   CP_TIME_SPAN.Format_Day_By_Calendar(SICK_REST, '90.0000', CALENDAR_ID) SICK_REST,\n   CP_TIME_SPAN.Format_Day_By_Calendar(VACATION_REST, '90.0000', CALENDAR_ID) VACATION_REST,\n   CP_TIME_SPAN.Format_Day_By_Calendar(MARRIAGE_REST, '90.0000', CALENDAR_ID) MARRIAGE_REST,\n   CP_TIME_SPAN.Format_Day_By_Calendar(MATERNITY_REST, '90.0000', CALENDAR_ID) MATERNITY_REST,\n   CP_TIME_SPAN.Format_Day_By_Calendar(MOURNING_REST, '90.0000', CALENDAR_ID) MOURNING_REST,\n   PM_USER_SERVICE_EI.Decode_Label(PM_USER_COMPANY_DI.Get_Service_Cd(COMPANY_ID)) SERVICE_CD,\n   TO_CHAR(PM_USER_COMPANY_DI.Get_Leave_Date(COMPANY_ID),'YYYY-MM-DD') LEAVE_DATE,\n   TO_CHAR(PM_USER_COMPANY_DI.Get_Entry_Date(COMPANY_ID),'YYYY-MM-DD') ENTRY_DATE,\n   MONTH_NOTE,\n   PM_USER_COMPANY_VACATION_DI.Get_Leave_Vacation_Ts(OUID, PM_USER_COMPANY_DI.Get_Leave_Date(COMPANY_ID)) LEAVE_REST_COUNT\nFROM (\n   SELECT\n      OUID,\n      PM_USER_COMPANY_DI.Get_Work_Number_By_User_Id(OUID) WORK_NUMBER,\n      PM_USER_COMPANY_DI.Get_Id_By_User_Id(OUID) COMPANY_ID,\n      PM_USER_DI.Get_Full_Label(OUID) USER_LABEL,\n      PM_USER_COMPANY_DI.Get_Fit_Calendar(OUID) CALENDAR_ID,\n      PM_ORGANIZATION_DI.Find_Main_Organization_Label(OUID) ORGANIZATION_LABEL,\n      PM_ATTENDANCE_SUMMARY_DI.Get_Late_Count(OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) LATE_COUNT,\n      PM_ATTENDANCE_SUMMARY_DI.Get_Leave_Count(OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) LEAVE_COUNT,\n      PM_ATTENDANCE_SUMMARY_DI.Get_Absenteeism_Count_Ts(OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) ABSENTEEISM_TS,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('CA',OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) CASUAL_REST,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('SK',OUID,CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) SICK_REST,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('VT',OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) VACATION_REST,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('MR', OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) MARRIAGE_REST,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('MA', OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) MATERNITY_REST,\n      PM_USER_COM_RST_DAY_DTL_DI.Get_Period_Summary_Ts('MO', OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) MOURNING_REST,\n      PM_ATTENDANCE_SUMMARY_DI.Get_Month_Note(OUID, CP_DATE.Parse('${BEGIN_DATE}'), CP_DATE.Parse('${END_DATE}')) MONTH_NOTE\n   FROM PM_USER\n   WHERE PM_USER_COMPANY_DI.Is_Valid_Staff_In_Date(OUID, CP_DATE.Parse('${BEGIN_DATE}')) = 'Y')\nORDER BY WORK_NUMBER" display_command="N" display_command_tag="N" display_head="N" display_head_tag="N" display_label="Y" display_label_tag="N" display_valid="N" display_valid_tag="N" is_open="N" export_name="eUIS-考勤管理-月报[${SETTLEMENT_BEGIN_DATE}-${SETTLEMENT_END_DATE}]" export_charset="GB18030" disp_data_start_tag="N" disp_data_end_tag="N" dataset_parameters="SELECT\n   TO_CHAR(CP_DATE.Parse('${BEGIN_DATE}'), 'YYYYMMDD') SETTLEMENT_BEGIN_DATE,\n   TO_CHAR(CP_DATE.Parse('${END_DATE}'), 'YYYYMMDD') SETTLEMENT_END_DATE\nFROM DUAL" />
</CsvImport>

